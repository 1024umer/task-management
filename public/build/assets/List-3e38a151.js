import{d as v}from"./default-61698ed5.js";import{S as h}from"./sweetalert2.all-82b1f328.js";import{_ as x,r,e as I,w as s,o as k,a as e,b as u,d as w,t as C}from"./app-b785c0d4.js";const f=new v("users"),V=new v("roles"),U={data(){return{roles:[],role_id:0,city:"",breadcrumbs:[{title:"Dashboard",to:{name:"auth.panel"},disabled:!1,exact:!0},{title:"Users",exact:!0,disabled:!0,to:{name:"auth.users.listing"}}],serverItems:[],totalItems:0,loading:!1,itemsPerPage:10,search:"",headers:[{title:"",align:"start",sortable:!0,key:"id"},{title:"Email",align:"start",sortable:!0,key:"email"},{title:"Name",align:"start",sortable:!0,key:"name"},{title:"User Name",align:"center",sortable:!0,key:"username"},{title:"Phone",align:"start",sortable:!0,key:"phone"},{title:"Role",align:"start",sortable:!0,key:"role_id"},{title:"Actions",sortable:!1,key:"actions"}]}},methods:{async loadItems({page:a,itemsPerPage:l,sortBy:n}){this.loading=!0,this.serverItems=[];var o="";o+="?page="+a;try{n.length>0&&(o+="&sortCol="+n[0].key,o+="&sortByDesc="+n[0].order)}catch{}o+="&perpage="+l,this.search!=""&&(o+="&search="+this.search),this.role_id>0&&(o+="&role_id="+this.role_id),this.city&&(o+="&city="+this.city);const t=await f.getlist(o);this.serverItems=t.data;try{this.totalItems=t.meta.total}catch{this.totalItems=0}this.loading=!1},async deleteItem(a){await h.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(n=>{if(n.isConfirmed)return!0})&&(await f.delete({id:a}),h.fire("Deleted!","Your record has been deleted.","success"),this.loadItems({page:1,itemsPerPage:10}))},async downlaod(a){}},watch:{$route(){this.loadItems({page:1,itemsPerPage:10})},itemsPerPage(){this.loadItems({page:1,itemsPerPage:10})},search(){this.loadItems({page:1,itemsPerPage:10})},role_id(){this.loadItems({page:1,itemsPerPage:10})},city(){this.loadItems({page:1,itemsPerPage:10})}},async mounted(){const a=await V.getlist("").then(l=>l.data);this.roles=[{id:0,title:"All"},...a],this.loadItems({page:1,itemsPerPage:10})},computed:{cities(){return[{keyt:"",text:"All"},...this.$store.getters.getCities]}}},B={class:"add-excel-btn"};function S(a,l,n,o,t,m){const p=r("v-icon"),b=r("v-breadcrumbs"),d=r("v-col"),c=r("v-btn"),y=r("v-text-field"),_=r("v-select"),g=r("v-row"),P=r("v-data-table-server");return k(),I(g,null,{default:s(()=>[e(d,null,{default:s(()=>[e(b,{items:t.breadcrumbs},{prepend:s(()=>[e(p,{size:"small",icon:"mdi-home-city"})]),divider:s(()=>[e(p,null,{default:s(()=>[u("mdi-forward")]),_:1})]),_:1},8,["items"])]),_:1}),e(d,{sm:"6",lg:"3",md:"3"},{default:s(()=>[w("div",B,[e(c,{class:"add-user",link:"",to:{name:"auth.users.add"}},{default:s(()=>[u("Add User")]),_:1},8,["to"]),e(c,{onClick:a.exportToXLSX,class:"export-excel"},{default:s(()=>[u("Export to XLSX")]),_:1},8,["onClick"])])]),_:1}),e(d,{cols:"12"},{default:s(()=>[e(g,null,{default:s(()=>[e(d,null,{default:s(()=>[e(y,{modelValue:t.search,"onUpdate:modelValue":l[0]||(l[0]=i=>t.search=i),label:"Search","single-line":"","hide-details":""},null,8,["modelValue"])]),_:1}),e(d,null,{default:s(()=>[e(_,{"item-title":"title","item-value":"id",label:"Roles",items:t.roles,modelValue:t.role_id,"onUpdate:modelValue":l[1]||(l[1]=i=>t.role_id=i)},null,8,["items","modelValue"])]),_:1}),e(d,null,{default:s(()=>[e(_,{"item-title":"text","item-value":"keyt",label:"City",items:m.cities,modelValue:t.city,"onUpdate:modelValue":l[2]||(l[2]=i=>t.city=i)},null,8,["items","modelValue"])]),_:1})]),_:1}),e(P,{"items-per-page":t.itemsPerPage,"onUpdate:itemsPerPage":l[3]||(l[3]=i=>t.itemsPerPage=i),headers:t.headers,"items-length":t.totalItems,items:t.serverItems,loading:t.loading,"item-value":"id","loading-text":"Loading","onUpdate:options":m.loadItems},{"item.role_id":s(({item:i})=>[u(C(i.role.title),1)]),"item.actions":s(({item:i})=>[e(c,{link:"",to:{name:"auth.users.edit",params:{id:i.id}},color:"info",density:"comfortable",size:"small",icon:"mdi-pencil-plus"},null,8,["to"]),e(c,{onClick:A=>m.deleteItem(i.id),color:"error",density:"comfortable",size:"small",icon:"mdi-delete-outline"},null,8,["onClick"])]),_:1},8,["items-per-page","headers","items-length","items","loading","onUpdate:options"])]),_:1})]),_:1})}const X=x(U,[["render",S]]);export{X as default};
